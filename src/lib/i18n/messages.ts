export const locales = ["fr", "ar", "en"] as const;
export type Locale = (typeof locales)[number];

export const messages = {
  en: {
    general: {
      loading: "Loading...",
    },
    nav: {
      books: "Books",
      orders: "Orders",
      account: "Account",
      admin: "Admin",
      cart: "Cart",
      login: "Log in",
      logout: "Log out",
      language: "Language",
    },
    home: {
      badge: "BookNest",
      tagline: "Discover your next favorite book",
      title: "BookNest is your cozy corner for thoughtful reads.",
      subtitle:
        "Browse curated collections, build your cart, and check out securely.",
      browse: "Browse books",
      signIn: "Sign in",
      featured: "Featured books",
      viewAll: "View all",
      categories: "Shop by category",
    },
    books: {
      title: "Browse books",
      subtitle: "Search by title, author, or filter by category.",
      viewCart: "View cart",
      search: "Search",
      searchPlaceholder: "Search for a book or author",
      category: "Category",
      all: "All",
      sortBy: "Sort by",
      newest: "Newest",
      priceLow: "Price: Low to high",
      priceHigh: "Price: High to low",
      apply: "Apply filters",
      empty: "No books match your search yet. Try another keyword or category.",
    },
    book: {
      by: "by",
      viewCart: "View cart",
      copiesAvailable: "copies available",
      outOfStock: "Currently out of stock",
      inStock: "in stock",
    },
    cart: {
      title: "Your cart",
      empty: "Your cart is empty. Browse the collection to add books.",
      browse: "Browse books",
      review: "Review your selections before checkout.",
      qty: "Qty",
      remove: "Remove",
      summary: "Order summary",
      subtotal: "Subtotal",
      taxes: "Taxes and shipping are calculated at checkout.",
      checkout: "Proceed to checkout",
      addToCart: "Add to cart",
      added: "Added to cart",
      outOfStock: "Out of stock",
    },
    checkout: {
      signInTitle: "Sign in to checkout",
      signInSubtitle: "Create an account or log in to complete your purchase.",
      goToAccount: "Go to account",
      emptyTitle: "Your cart is empty",
      emptySubtitle: "Add books to your cart before checking out.",
      overview: "Checkout overview",
      total: "Total",
      pay: "Confirm order via WhatsApp",
      redirecting: "Preparing...",
      stripeNote: "You will be redirected to WhatsApp to confirm payment.",
      manualTitle: "Manual payment options",
      manualSubtitle:
        "Send your payment to one of the numbers below, then confirm on WhatsApp.",
      methodBankily: "Bankily",
      methodSedad: "Sedad",
      methodMasrivi: "Masrivi",
      whatsappHint: "Send a payment screenshot to confirm your order.",
      orderCreated: "Order created. We will confirm after receiving your proof.",
    },
    success: {
      title: "Payment confirmed!",
      subtitle: "Thank you for your purchase. We have emailed your receipt and created your order.",
      missing: "Missing session",
      missingNote: "We could not find your Stripe session. Check your orders instead.",
      continue: "Continue shopping",
      viewOrders: "View orders",
      orderTotal: "Order total",
      finalizing:
        "We are finalizing your order. Refresh in a moment or check your orders page.",
    },
    account: {
      title: "My account",
      subtitle: "Manage your profile and orders.",
      overview: "Overview",
      memberSince: "Member since",
      orders: "Orders",
      settings: "Settings",
      member: "BookNest member",
      status: "Status",
      active: "Active",
      recentOrders: "Recent orders",
      viewAll: "View all",
      noOrders: "No orders yet. Browse the catalog to get started.",
      quickActions: "Quick actions",
      editProfile: "Edit profile",
      trackOrders: "Track orders",
      signIn: "Log in",
      signUp: "Create account",
      settingsIntro: "Manage your profile details and access.",
      profileInfo: "Profile information",
      profileName: "Full name",
      profileEmail: "Email",
      profileRole: "Role",
      profileJoined: "Joined",
      settingsNote: "Account edits are coming soon.",
    },
    orders: {
      title: "Your orders",
      subtitle: "Track your BookNest purchases.",
      empty: "No orders yet. Browse the catalog and place your first order.",
      continue: "Continue shopping",
      orderTotal: "Order total",
      status: "Status",
    },
    status: {
      pending: "Pending",
      confirmed: "Confirmed",
      ready: "Ready for delivery",
      inTransit: "On the way",
      delivered: "Delivered",
      cancelled: "Cancelled",
    },
    admin: {
      dashboard: "Admin dashboard",
      manage: "Manage the catalog and review recent orders.",
      manageBooks: "Manage books",
      manageCategories: "Manage categories",
      recentOrders: "Recent orders",
      noOrders: "No orders yet.",
      books: "Books",
      categories: "Categories",
      back: "Back to dashboard",
      orders: "Orders",
      users: "Users",
      placeholderOrders: "Orders management view placeholder.",
      placeholderUsers: "Users management view placeholder.",
      usersIntro: "Review signed-in users and admin access.",
      noUsers: "No users yet.",
      userName: "Name",
      userEmail: "Email",
      userRole: "Role",
      userCreatedAt: "Created",
      makeAdmin: "Make admin",
      makeUser: "Make user",
      saving: "Saving...",
    },
    auth: {
      email: "Email",
      password: "Password",
      name: "Name",
      signingIn: "Signing in...",
      creating: "Creating account...",
      invalid: "Invalid email or password",
    },
  },
  fr: {
    general: {
      loading: "Chargement...",
    },
    nav: {
      books: "Livres",
      orders: "Commandes",
      account: "Compte",
      admin: "Admin",
      cart: "Panier",
      login: "Se connecter",
      logout: "Se déconnecter",
      language: "Langue",
    },
    home: {
      badge: "BookNest",
      tagline: "Découvrez votre prochain livre préféré",
      title: "BookNest est votre coin cosy pour des lectures inspirantes.",
      subtitle:
        "Parcourez des collections sélectionnées, préparez votre panier et payez en toute sécurité.",
      browse: "Voir les livres",
      signIn: "Se connecter",
      featured: "Livres en vedette",
      viewAll: "Tout voir",
      categories: "Acheter par catégorie",
    },
    books: {
      title: "Parcourir les livres",
      subtitle: "Recherchez par titre, auteur ou filtrez par catégorie.",
      viewCart: "Voir le panier",
      search: "Recherche",
      searchPlaceholder: "Rechercher un livre ou un auteur",
      category: "Catégorie",
      all: "Toutes",
      sortBy: "Trier par",
      newest: "Les plus récents",
      priceLow: "Prix : croissant",
      priceHigh: "Prix : décroissant",
      apply: "Appliquer",
      empty: "Aucun livre ne correspond à votre recherche.",
    },
    book: {
      by: "par",
      viewCart: "Voir le panier",
      copiesAvailable: "exemplaires disponibles",
      outOfStock: "Rupture de stock",
      inStock: "en stock",
    },
    cart: {
      title: "Votre panier",
      empty: "Votre panier est vide. Ajoutez des livres pour commencer.",
      browse: "Voir les livres",
      review: "Vérifiez vos choix avant de payer.",
      qty: "Qté",
      remove: "Retirer",
      summary: "Récapitulatif",
      subtotal: "Sous-total",
      taxes: "Taxes et livraison calculées au paiement.",
      checkout: "Passer au paiement",
      addToCart: "Ajouter au panier",
      added: "Ajouté au panier",
      outOfStock: "Rupture de stock",
    },
    checkout: {
      signInTitle: "Connectez-vous pour payer",
      signInSubtitle: "Créez un compte ou connectez-vous pour finaliser.",
      goToAccount: "Aller au compte",
      emptyTitle: "Votre panier est vide",
      emptySubtitle: "Ajoutez des livres avant de payer.",
      overview: "Récapitulatif du paiement",
      total: "Total",
      pay: "Confirmer via WhatsApp",
      redirecting: "Préparation...",
      stripeNote: "Vous serez redirigé vers WhatsApp pour confirmer.",
      manualTitle: "Options de paiement manuel",
      manualSubtitle:
        "Envoyez votre paiement à l'un des numéros ci-dessous, puis confirmez sur WhatsApp.",
      methodBankily: "Bankily",
      methodSedad: "Sedad",
      methodMasrivi: "Masrivi",
      whatsappHint: "Envoyez une capture du paiement pour confirmer votre commande.",
      orderCreated: "Commande créée. Nous confirmerons après réception.",
    },
    success: {
      title: "Paiement confirmé !",
      subtitle: "Merci pour votre achat. Nous avons créé votre commande.",
      missing: "Session manquante",
      missingNote: "Nous n'avons pas trouvé votre session Stripe.",
      continue: "Continuer vos achats",
      viewOrders: "Voir les commandes",
      orderTotal: "Total de la commande",
      finalizing:
        "Nous finalisons votre commande. Actualisez dans un instant.",
    },
    account: {
      title: "Mon compte",
      subtitle: "Gérez votre profil et vos commandes.",
      overview: "Aperçu",
      memberSince: "Membre depuis",
      orders: "Commandes",
      settings: "Paramètres",
      member: "Membre BookNest",
      status: "Statut",
      active: "Actif",
      recentOrders: "Commandes récentes",
      viewAll: "Tout voir",
      noOrders: "Aucune commande pour l'instant.",
      quickActions: "Actions rapides",
      editProfile: "Modifier le profil",
      trackOrders: "Suivre les commandes",
      signIn: "Se connecter",
      signUp: "Créer un compte",
      settingsIntro: "Gérez vos informations et vos accès.",
      profileInfo: "Informations du profil",
      profileName: "Nom complet",
      profileEmail: "Email",
      profileRole: "Rôle",
      profileJoined: "Inscrit le",
      settingsNote: "La modification du profil arrive bientôt.",
    },
    orders: {
      title: "Vos commandes",
      subtitle: "Suivez vos achats BookNest.",
      empty: "Aucune commande pour l'instant.",
      continue: "Continuer vos achats",
      orderTotal: "Total de la commande",
      status: "Statut",
    },
    status: {
      pending: "En attente",
      confirmed: "Confirmée",
      ready: "Prête pour la livraison",
      inTransit: "En route",
      delivered: "Livrée",
      cancelled: "Annulée",
    },
    admin: {
      dashboard: "Tableau de bord",
      manage: "Gérez le catalogue et les commandes.",
      manageBooks: "Gérer les livres",
      manageCategories: "Gérer les catégories",
      recentOrders: "Commandes récentes",
      noOrders: "Aucune commande.",
      books: "Livres",
      categories: "Catégories",
      back: "Retour au tableau",
      orders: "Commandes",
      users: "Utilisateurs",
      placeholderOrders: "Espace commandes à connecter.",
      placeholderUsers: "Espace utilisateurs à connecter.",
      usersIntro: "Consultez les utilisateurs connectés et l'accès admin.",
      noUsers: "Aucun utilisateur pour l'instant.",
      userName: "Nom",
      userEmail: "Email",
      userRole: "Rôle",
      userCreatedAt: "Créé le",
      makeAdmin: "Rendre admin",
      makeUser: "Rendre utilisateur",
      saving: "Enregistrement...",
    },
    auth: {
      email: "Email",
      password: "Mot de passe",
      name: "Nom",
      signingIn: "Connexion...",
      creating: "Création du compte...",
      invalid: "Email ou mot de passe incorrect",
    },
  },
  ar: {
    general: {
      loading: "جاري التحميل...",
    },
    nav: {
      books: "الكتب",
      orders: "الطلبات",
      account: "الحساب",
      admin: "الإدارة",
      cart: "السلة",
      login: "تسجيل الدخول",
      logout: "تسجيل الخروج",
      language: "اللغة",
    },
    home: {
      badge: "بوكنست",
      tagline: "اكتشف كتابك المفضل القادم",
      title: "بوكنست هو ركنك الدافئ للقراءات الهادئة.",
      subtitle:
        "تصفح مجموعات مختارة، أنشئ سلتك، وادفع بأمان.",
      browse: "تصفح الكتب",
      signIn: "تسجيل الدخول",
      featured: "كتب مميزة",
      viewAll: "عرض الكل",
      categories: "تسوق حسب الفئة",
    },
    books: {
      title: "تصفح الكتب",
      subtitle: "ابحث بالعنوان أو المؤلف أو حسب الفئة.",
      viewCart: "عرض السلة",
      search: "بحث",
      searchPlaceholder: "ابحث عن كتاب أو مؤلف",
      category: "الفئة",
      all: "الكل",
      sortBy: "ترتيب حسب",
      newest: "الأحدث",
      priceLow: "السعر: من الأقل للأعلى",
      priceHigh: "السعر: من الأعلى للأقل",
      apply: "تطبيق الفلاتر",
      empty: "لا توجد كتب مطابقة لبحثك.",
    },
    book: {
      by: "بواسطة",
      viewCart: "عرض السلة",
      copiesAvailable: "نسخ متاحة",
      outOfStock: "غير متوفر حالياً",
      inStock: "متوفر",
    },
    cart: {
      title: "سلتك",
      empty: "سلتك فارغة. أضف كتباً للبدء.",
      browse: "تصفح الكتب",
      review: "راجع اختياراتك قبل الدفع.",
      qty: "الكمية",
      remove: "حذف",
      summary: "ملخص الطلب",
      subtotal: "الإجمالي",
      taxes: "يتم احتساب الضرائب والشحن عند الدفع.",
      checkout: "المتابعة للدفع",
      addToCart: "أضف إلى السلة",
      added: "تمت الإضافة إلى السلة",
      outOfStock: "غير متوفر",
    },
    checkout: {
      signInTitle: "سجّل الدخول لإتمام الدفع",
      signInSubtitle: "أنشئ حساباً أو سجّل الدخول لإكمال الشراء.",
      goToAccount: "الذهاب للحساب",
      emptyTitle: "سلتك فارغة",
      emptySubtitle: "أضف كتباً قبل الدفع.",
      overview: "ملخص الدفع",
      total: "الإجمالي",
      pay: "تأكيد عبر واتساب",
      redirecting: "جارٍ التحضير...",
      stripeNote: "سيتم تحويلك إلى واتساب لتأكيد الدفع.",
      manualTitle: "خيارات الدفع اليدوي",
      manualSubtitle:
        "أرسل الدفع إلى أحد الأرقام أدناه ثم أرسل الإثبات عبر واتساب.",
      methodBankily: "بانكيلي",
      methodSedad: "سداد",
      methodMasrivi: "مصرفي",
      whatsappHint: "أرسل صورة إثبات الدفع لتأكيد الطلب.",
      orderCreated: "تم إنشاء الطلب. سنؤكد بعد استلام الإثبات.",
    },
    success: {
      title: "تم تأكيد الدفع!",
      subtitle: "شكراً لشرائك. تم إنشاء طلبك.",
      missing: "جلسة مفقودة",
      missingNote: "لم نتمكن من العثور على جلسة Stripe.",
      continue: "متابعة التسوق",
      viewOrders: "عرض الطلبات",
      orderTotal: "إجمالي الطلب",
      finalizing: "نقوم بإكمال طلبك. أعد المحاولة بعد قليل.",
    },
    account: {
      title: "حسابي",
      subtitle: "إدارة الملف الشخصي والطلبات.",
      overview: "نظرة عامة",
      memberSince: "عضو منذ",
      orders: "الطلبات",
      settings: "الإعدادات",
      member: "عضو بوكنست",
      status: "الحالة",
      active: "نشط",
      recentOrders: "الطلبات الأخيرة",
      viewAll: "عرض الكل",
      noOrders: "لا توجد طلبات بعد.",
      quickActions: "إجراءات سريعة",
      editProfile: "تعديل الملف",
      trackOrders: "تتبع الطلبات",
      signIn: "تسجيل الدخول",
      signUp: "إنشاء حساب",
      settingsIntro: "إدارة معلومات الملف والصلاحيات.",
      profileInfo: "معلومات الملف",
      profileName: "الاسم الكامل",
      profileEmail: "البريد الإلكتروني",
      profileRole: "الدور",
      profileJoined: "تاريخ الانضمام",
      settingsNote: "تعديل الحساب سيضاف قريباً.",
    },
    orders: {
      title: "طلباتك",
      subtitle: "تابع مشترياتك من بوكنست.",
      empty: "لا توجد طلبات بعد.",
      continue: "متابعة التسوق",
      orderTotal: "إجمالي الطلب",
      status: "الحالة",
    },
    status: {
      pending: "قيد الانتظار",
      confirmed: "تم التأكيد",
      ready: "جاهز للتوصيل",
      inTransit: "في الطريق",
      delivered: "تم التوصيل",
      cancelled: "ملغي",
    },
    admin: {
      dashboard: "لوحة التحكم",
      manage: "إدارة الكتالوج والطلبات.",
      manageBooks: "إدارة الكتب",
      manageCategories: "إدارة الفئات",
      recentOrders: "الطلبات الأخيرة",
      noOrders: "لا توجد طلبات.",
      books: "الكتب",
      categories: "الفئات",
      back: "العودة للوحة التحكم",
      orders: "الطلبات",
      users: "المستخدمون",
      placeholderOrders: "مكان إدارة الطلبات.",
      placeholderUsers: "مكان إدارة المستخدمين.",
      usersIntro: "عرض المستخدمين المسجلين وصلاحيات الإدارة.",
      noUsers: "لا يوجد مستخدمون بعد.",
      userName: "الاسم",
      userEmail: "البريد الإلكتروني",
      userRole: "الدور",
      userCreatedAt: "تاريخ الإنشاء",
      makeAdmin: "تعيين كمسؤول",
      makeUser: "تعيين كمستخدم",
      saving: "جارٍ الحفظ...",
    },
    auth: {
      email: "البريد الإلكتروني",
      password: "كلمة المرور",
      name: "الاسم",
      signingIn: "جارٍ تسجيل الدخول...",
      creating: "جارٍ إنشاء الحساب...",
      invalid: "البريد الإلكتروني أو كلمة المرور غير صحيحة",
    },
  },
} satisfies Record<Locale, Record<string, unknown>>;

export function createTranslator(locale: Locale) {
  return (key: string) => {
    const parts = key.split(".");
    let current: any = messages[locale];
    for (const part of parts) {
      current = current?.[part];
      if (current === undefined) {
        return key;
      }
    }
    return typeof current === "string" ? current : key;
  };
}

export function normalizeLocale(value: string | undefined): Locale | null {
  if (!value) {
    return null;
  }
  const candidate = value.toLowerCase().split("-")[0];
  return (locales as readonly string[]).includes(candidate)
    ? (candidate as Locale)
    : null;
}
